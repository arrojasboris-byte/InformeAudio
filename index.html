<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Control Center Audio</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Chart.js para los gr√°ficos demo -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

  <style>
    :root {
      --bg-main: radial-gradient(circle at top left, #111827, #020617 55%);
      --bg-main-light: #f3f4f6;
      --bg-card: #020617;
      --bg-card-soft: #0b1120;
      --bg-card-light: #ffffff;
      --text-main: #f9fafb;
      --text-main-light: #111827;
      --text-muted: #9ca3af;
      --text-muted-light: #6b7280;
      --border-soft: #1f2937;
      --border-soft-light: #e5e7eb;
      --accent-red: #ff2440;
      --accent-blue: #38bdf8;
      --accent-green: #22c55e;
      --accent-orange: #f97316;
      --accent-purple: #a855f7;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text", sans-serif;
    }

    html, body {
      width: 100%;
      height: 100%;
      overflow: hidden; /* cada p√°gina tiene su propio scroll vertical */
    }

    body {
      display: flex;
      background: var(--bg-main);
      color: var(--text-main);
    }

    /* ===== SIDEBAR ===== */
    .sidebar {
      width: 250px;
      background: #020617;
      border-right: 1px solid #020617;
      padding: 18px 18px 24px;
      display: flex;
      flex-direction: column;
      gap: 24px;
      color: #e5e7eb;
      flex-shrink: 0;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .logo-badge {
      width: 34px;
      height: 34px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 20%, #fee2e2, var(--accent-red));
    }

    .logo-text {
      display: flex;
      flex-direction: column;
    }

    .logo-title {
      font-weight: 700;
      font-size: 1.05rem;
    }

    .logo-subtitle {
      font-size: .7rem;
      color: #9ca3af;
    }

    .section-title {
      font-size: .75rem;
      text-transform: uppercase;
      color: #6b7280;
      letter-spacing: .12em;
      margin-bottom: 8px;
    }

    .nav-list {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .nav-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 8px 10px;
      border-radius: 999px;
      font-size: .88rem;
      color: #9ca3af;
      cursor: pointer;
      transition: all .18s ease;
      white-space: nowrap;
    }

    .nav-item span.icon {
      width: 22px;
      height: 22px;
      border-radius: 999px;
      background: #020617;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: .75rem;
    }

    .nav-item.active {
      background: linear-gradient(90deg, #ff2440, #fb7185);
      color: #111827;
      font-weight: 600;
    }

    .nav-item.active span.icon {
      background: rgba(15,23,42,.2);
    }

    .nav-item:hover:not(.active) {
      background: rgba(31,41,55,0.9);
      color: #e5e7eb;
    }

    .sidebar-footer {
      margin-top: auto;
      font-size: .78rem;
      color: #9ca3af;
    }

    /* ===== MAIN / TOPBAR ===== */
    .main {
      flex: 1;
      display: flex;
      flex-direction: column;
      padding: 10px 18px 12px;
      max-width: calc(100vw - 250px);
      overflow: hidden;
    }

    .topbar {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 6px;
    }

    .search-wrapper-main {
      flex: 1;
      position: relative;
    }

    .search-input-main {
      width: 100%;
      border-radius: 999px;
      border: 1px solid var(--border-soft);
      background: #020617;
      padding: 8px 12px 8px 32px;
      color: var(--text-main);
      font-size: .86rem;
      outline: none;
    }

    .search-wrapper-main .search-icon {
      position: absolute;
      left: 10px;
      top: 50%;
      transform: translateY(-50%);
      font-size: .8rem;
      color: var(--text-muted);
    }

    .btn {
      border-radius: 999px;
      padding: 6px 14px;
      border: 1px solid var(--border-soft);
      font-size: .8rem;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: #020617;
      color: #e5e7eb;
      white-space: nowrap;
      box-shadow: none;
    }

    .btn span.icon {
      font-size: .9rem;
    }

    .btn-cta-blue {
      background: linear-gradient(90deg, #38bdf8, #0ea5e9);
      border-color: transparent;
      color: #020617;
      font-weight: 600;
    }

    .btn-cta-green {
      background: linear-gradient(90deg, #22c55e, #4ade80);
      border-color: transparent;
      color: #022c22;
      font-weight: 600;
    }

    .btn-cta-pink {
      background: linear-gradient(90deg, #ff2440, #fb7185);
      border-color: transparent;
      color: #111827;
      font-weight: 600;
    }

    /* ===== P√ÅGINAS ===== */
    .pages {
      flex: 1;
      border-radius: 16px;
      border: 1px solid var(--border-soft);
      background: #020617;
      margin-top: 6px;
      overflow: hidden;
    }

    .page {
      width: 100%;
      height: calc(100% - 0px);
      overflow-y: auto;
      overflow-x: hidden;
      display: none;
      padding: 10px 14px 14px;
    }

    .page.active {
      display: block;
    }

    .page-title {
      font-size: 1.05rem;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .card {
      background: var(--bg-card-soft);
      border-radius: 14px;
      border: 1px solid var(--border-soft);
      padding: 10px;
      color: var(--text-main);
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 6px;
      font-size: .86rem;
      font-weight: 600;
    }

    /* ===== DASHBOARD ===== */

    .dashboard-filtros {
      display: flex;
      gap: 8px;
      margin-bottom: 8px;
      flex-wrap: wrap;
      align-items: center;
      font-size: .8rem;
    }

    .filter-select {
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid var(--border-soft);
      background: #020617;
      color: var(--text-main);
      font-size: .8rem;
      outline: none;
    }

    .dashboard-kpi-row {
      display: grid;
      grid-template-columns: 2.1fr 1fr;
      gap: 10px;
      margin-bottom: 10px;
    }

    .kpi-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 8px;
    }

    .kpi-card {
      background: var(--bg-card-soft);
      border-radius: 12px;
      border: 1px solid var(--border-soft);
      padding: 6px 8px;
      font-size: .78rem;
      display: flex;
      flex-direction: column;
      gap: 2px;
      min-height: 54px;
    }

    .kpi-label {
      color: var(--text-muted);
    }

    .kpi-value {
      font-weight: 600;
      font-size: .9rem;
    }

    .kpi-sub {
      font-size: .7rem;
      color: var(--text-muted);
    }

    .ranking-card {
      height: 100%;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .ranking-kpi-selector {
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
      font-size: .72rem;
    }

    .chip {
      border-radius: 999px;
      padding: 2px 8px;
      border: 1px solid var(--border-soft);
      cursor: pointer;
      background: #020617;
      color: var(--text-muted);
    }

    .chip.active {
      background: #38bdf8;
      color: #020617;
      border-color: #38bdf8;
      font-weight: 600;
    }

    .ranking-list {
      margin-top: 4px;
      font-size: .8rem;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .ranking-item {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .ranking-position {
      width: 14px;
      text-align: right;
      color: var(--text-muted);
      font-size: .72rem;
    }

    .ranking-name {
      width: 90px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .ranking-bar-wrap {
      flex: 1;
      height: 6px;
      border-radius: 999px;
      background: #020617;
      overflow: hidden;
    }

    .ranking-bar {
      height: 100%;
      border-radius: 999px;
      background: linear-gradient(90deg, #38bdf8, #0ea5e9);
    }

    .ranking-value {
      width: 32px;
      text-align: right;
      font-size: .72rem;
      color: var(--text-muted);
    }

    .ranking-more {
      margin-top: 2px;
      text-align: right;
      font-size: .75rem;
      color: #38bdf8;
      cursor: pointer;
      text-decoration: underline;
    }

    .dashboard-charts {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      grid-auto-rows: 250px;
      gap: 10px;
    }

    .chart-card {
      position: relative;
      padding: 8px 8px 4px;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .chart-title {
      font-size: .8rem;
      font-weight: 600;
    }

    .chart-body {
      flex: 1;
      position: relative;
    }

    .chart-body canvas {
      position: absolute;
      inset: 0;
    }

    /* ===== INFORME DE LA VISITA ===== */

    .informe-grid-top {
      display: grid;
      grid-template-columns: 1.6fr 1.1fr;
      gap: 10px;
      margin-bottom: 10px;
      align-items: stretch;
    }

    .informe-datos-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 4px 8px;
      font-size: .8rem;
    }

    .form-field {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .form-field label {
      font-size: .72rem;
      color: var(--text-muted);
    }

    .form-field input,
    .form-field select {
      border-radius: 8px;
      border: 1px solid var(--border-soft);
      background: #020617;
      color: var(--text-main);
      font-size: .8rem;
      padding: 4px 8px;
      outline: none;
    }

    .form-inline-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
    }

    .informe-kpi-radar {
      display: grid;
      grid-template-columns: 1.1fr 1.1fr;
      gap: 8px;
      margin-bottom: 10px;
    }

    .informe-kpi-bars .chart-body {
      min-height: 200px;
    }

    .informe-radar .chart-body {
      min-height: 200px;
    }

    .informe-mid-grid {
      display: grid;
      grid-template-columns: 1.1fr 1.3fr;
      gap: 10px;
      margin-bottom: 10px;
      align-items: stretch;
    }

    .checklist-scroll {
      max-height: 280px;
      overflow-y: auto;
      font-size: .8rem;
      padding-right: 2px;
    }

    .checklist-item {
      display: flex;
      align-items: center;
      gap: 4px;
      margin-bottom: 2px;
    }

    .checklist-item label {
      font-size: .8rem;
    }

    .imagenes-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 8px;
    }

    .imagen-slot {
      border-radius: 12px;
      border: 1px dashed var(--border-soft);
      background: #020617;
      height: 160px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-size: .8rem;
      color: var(--text-muted);
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }

    .imagen-slot input {
      display: none;
    }

    .imagen-slot img {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .imagen-slot span {
      position: relative;
      z-index: 2;
      text-align: center;
    }

    .informe-resumen-charts {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 10px;
      margin-bottom: 10px;
    }

    .observaciones-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 8px;
      margin-top: 6px;
    }

    .observaciones-grid textarea {
      width: 100%;
      border-radius: 10px;
      border: 1px solid var(--border-soft);
      background: #020617;
      color: var(--text-main);
      font-size: .8rem;
      padding: 6px 8px;
      min-height: 90px;
      resize: vertical;
      outline: none;
    }

    .informe-footer-actions {
      display: flex;
      justify-content: flex-end;
      margin-top: 8px;
      gap: 6px;
    }

    /* ===== PLACEHOLDER CENTROS ===== */

    .placeholder-centros {
      font-size: .86rem;
      padding: 8px;
      border-radius: 10px;
      border: 1px dashed var(--border-soft);
      background: #020617;
      color: var(--text-muted);
    }

    /* ===== TEMA CLARO ===== */

    body.light {
      background: var(--bg-main-light);
      color: var(--text-main-light);
    }

    body.light .sidebar {
      background: #020617; /* fald√≥n oscuro en tema claro */
      border-right-color: #020617;
    }

    body.light .main {
      background: var(--bg-main-light);
    }

    body.light .pages {
      background: #f9fafb;
      border-color: var(--border-soft-light);
    }

    body.light .page {
      color: var(--text-main-light);
    }

    body.light .card,
    body.light .kpi-card,
    body.light .chart-card {
      background: var(--bg-card-light);
      border-color: var(--border-soft-light);
      color: var(--text-main-light);
    }

    body.light .search-input-main,
    body.light .filter-select,
    body.light .form-field input,
    body.light .form-field select,
    body.light .imagen-slot,
    body.light .placeholder-centros,
    body.light .checklist-scroll {
      background: #ffffff;
      border-color: #e5e7eb;
      color: var(--text-main-light);
    }

    body.light .search-wrapper-main .search-icon,
    body.light .kpi-label,
    body.light .kpi-sub,
    body.light .form-field label {
      color: var(--text-muted-light);
    }

    body.light .ranking-bar-wrap {
      background: #e5e7eb;
    }

    body.light .btn {
      background: #111827;
      border-color: #111827;
      color: #f9fafb;
    }

    body.light .btn-cta-blue,
    body.light .btn-cta-green,
    body.light .btn-cta-pink {
      color: #111827;
    }

    body.light .observaciones-grid textarea {
      background: #ffffff;
      border-color: #e5e7eb;
      color: var(--text-main-light);
    }

    /* ===== PRINT ===== */
    @media print {
      body {
        background: #ffffff !important;
      }
      .sidebar,
      .topbar {
        display: none !important;
      }
      .main {
        max-width: 100% !important;
        padding: 0 !important;
      }
      .pages {
        border: none;
        border-radius: 0;
      }
      .page {
        padding: 10px 12px !important;
        height: auto !important;
        overflow: visible !important;
      }
    }
  </style>
</head>
<body>
  <!-- SIDEBAR -->
  <aside class="sidebar">
    <div class="logo">
      <div class="logo-badge"></div>
      <div class="logo-text">
        <span class="logo-title">Control Center Audio</span>
        <span class="logo-subtitle">Gesti√≥n de centros y delegados</span>
      </div>
    </div>

    <div>
      <div class="section-title">Secciones</div>
      <nav class="nav-list" id="mainNav">
        <div class="nav-item active" data-page="page-dashboard">
          <span class="icon">üìä</span> Dashboard
        </div>
        <div class="nav-item" data-page="page-centros">
          <span class="icon">üè¢</span> Centros
        </div>
        <div class="nav-item" data-page="page-informe">
          <span class="icon">üìã</span> Informe de la visita
        </div>
        <div class="nav-item" data-page="page-servicios">
          <span class="icon">‚úñ</span> Servicios
        </div>
        <div class="nav-item" data-page="page-ventas">
          <span class="icon">‚úñ</span> Ventas
        </div>
        <div class="nav-item" data-page="page-proyectos">
          <span class="icon">‚úñ</span> Proyectos
        </div>
      </nav>
    </div>

    <div class="sidebar-footer">
      Versi√≥n demo ¬∑ Datos ficticios
    </div>
  </aside>

  <!-- MAIN -->
  <main class="main">
    <!-- TOPBAR -->
    <div class="topbar">
      <div class="search-wrapper-main">
        <span class="search-icon">üîç</span>
        <input class="search-input-main" placeholder="Buscar por centro, propietario o delegado..." />
      </div>

      <button class="btn btn-cta-blue" id="themeToggle">
        <span class="icon">üåì</span> Oscuro / Claro
      </button>
      <button class="btn btn-cta-green" id="btnSaveView">
        <span class="icon">üíæ</span> Guardar vista
      </button>
      <button class="btn btn-cta-blue" id="btnExportHtml">
        <span class="icon">‚¨áÔ∏è</span> Exportar HTML
      </button>
      <button class="btn btn-cta-green" id="btnPrint">
        <span class="icon">üñ®</span> Imprimir
      </button>
      <button class="btn btn-cta-pink">
        <span class="icon">‚òÅÔ∏è</span> Actualizar datos nube
      </button>
    </div>

    <!-- PAGES WRAPPER -->
    <div class="pages">
      <!-- DASHBOARD -->
      <section id="page-dashboard" class="page active">
        <div class="page-title">Dashboard</div>

        <!-- Filtros -->
        <div class="dashboard-filtros">
          <select id="filtroPeriodo" class="filter-select">
            <option value="2025">A√±o 2025 (demo)</option>
            <option value="2024">A√±o 2024</option>
          </select>
          <select id="filtroDelegado" class="filter-select">
            <option value="todos">Todos los delegados</option>
            <option value="Sergio Per√°n">Sergio Per√°n</option>
            <option value="Daniel Chazo">Daniel Chazo</option>
            <option value="Eneritz ARANGUREN">Eneritz ARANGUREN</option>
            <option value="Blanca Fdez. de la Pradilla">Blanca Fdez. de la Pradilla</option>
          </select>
          <select id="filtroCentro" class="filter-select">
            <option value="todos">Todos los centros</option>
            <option value="PAMPLONA C. Exclusivo">PAMPLONA C. Exclusivo</option>
            <option value="REINA DE MERCEDES">REINA DE MERCEDES</option>
            <option value="SANTANDER CC PE√ëACASTILLO">SANTANDER CC PE√ëACASTILLO</option>
          </select>
        </div>

        <!-- KPI + Ranking -->
        <div class="dashboard-kpi-row">
          <div class="kpi-grid">
            <div class="kpi-card">
              <span class="kpi-label">% Procesos</span>
              <span class="kpi-value" id="kpiProcesos">‚Äì</span>
              <span class="kpi-sub">Objetivo 85‚Äì100%</span>
            </div>
            <div class="kpi-card">
              <span class="kpi-label">Conv. a prueba</span>
              <span class="kpi-value" id="kpiPrueba">‚Äì</span>
              <span class="kpi-sub">Objetivo 80%</span>
            </div>
            <div class="kpi-card">
              <span class="kpi-label">Conv. a venta</span>
              <span class="kpi-value" id="kpiVenta">‚Äì</span>
              <span class="kpi-sub">Objetivo 80%</span>
            </div>
            <div class="kpi-card">
              <span class="kpi-label">Formaciones %</span>
              <span class="kpi-value" id="kpiFormaciones">‚Äì</span>
              <span class="kpi-sub">Media de m√≥dulos</span>
            </div>
            <div class="kpi-card">
              <span class="kpi-label">AAR</span>
              <span class="kpi-value" id="kpiAAR">‚Äì</span>
              <span class="kpi-sub">Centros con AAR</span>
            </div>
            <div class="kpi-card">
              <span class="kpi-label">Primeros auxilios %</span>
              <span class="kpi-value" id="kpiPrimerosAuxilios">‚Äì</span>
              <span class="kpi-sub">Equipos formados</span>
            </div>
          </div>

          <div class="card ranking-card">
            <div class="card-header">
              <span>Ranking de delegados por KPI</span>
            </div>
            <div class="ranking-kpi-selector" id="rankingKpiSelector">
              <span class="chip active" data-kpi="procesos">% Procesos</span>
              <span class="chip" data-kpi="prueba">Conv. prueba</span>
              <span class="chip" data-kpi="venta">Conv. venta</span>
              <span class="chip" data-kpi="hit">HIT</span>
              <span class="chip" data-kpi="formaciones">Formaciones</span>
              <span class="chip" data-kpi="aar">AAR</span>
              <span class="chip" data-kpi="primeros">Primeros auxilios</span>
            </div>
            <div class="ranking-list" id="rankingList"></div>
            <div class="ranking-more">Mostrar todos</div>
          </div>
        </div>

        <!-- Gr√°ficos 3 + 3 -->
        <div class="dashboard-charts">
          <div class="card chart-card">
            <div class="chart-title">Radar general</div>
            <div class="chart-body">
              <canvas id="chartRadarGeneral"></canvas>
            </div>
          </div>

          <div class="card chart-card">
            <div class="chart-title">Procesos y √°reas de mejora por mes</div>
            <div class="chart-body">
              <canvas id="chartProcesosAreas"></canvas>
            </div>
          </div>

          <div class="card chart-card">
            <div class="chart-title">√Åreas de mejora por mes</div>
            <div class="chart-body">
              <canvas id="chartAreasMes"></canvas>
            </div>
          </div>

          <div class="card chart-card">
            <div class="chart-title">Primeros auxilios por mes</div>
            <div class="chart-body">
              <canvas id="chartPrimerosMes"></canvas>
            </div>
          </div>

          <div class="card chart-card">
            <div class="chart-title">Top 10 √°reas de mejora</div>
            <div class="chart-body">
              <canvas id="chartTopAreas"></canvas>
            </div>
          </div>

          <div class="card chart-card">
            <div class="chart-title">Aplicaci√≥n AAR / HIT</div>
            <div class="chart-body">
              <canvas id="chartAarHit"></canvas>
            </div>
          </div>
        </div>
      </section>

      <!-- CENTROS (placeholder para que pegues tu m√≥dulo actual) -->
      <section id="page-centros" class="page">
        <div class="page-title">Centros</div>
        <div class="placeholder-centros">
          Aqu√≠ puedes mantener tu m√≥dulo completo de <strong>Centros</strong> con calendario,
          delegados y tabla de centros. Sustituye este bloque por tu c√≥digo actual sin tocar
          el resto de la estructura.  
          <br /><br />
          La navegaci√≥n, el tema y los botones superiores seguir√°n funcionando igual.
        </div>
      </section>

      <!-- INFORME DE LA VISITA -->
      <section id="page-informe" class="page">
        <div class="page-title">Informe de la visita</div>

        <!-- Panel 1: datos del centro + checklist -->
        <div class="informe-grid-top">
          <div class="card">
            <div class="card-header">
              <span>Datos del centro</span>
            </div>
            <div class="informe-datos-grid">
              <div class="form-field">
                <label>Centro</label>
                <input id="infCentro" />
              </div>
              <div class="form-field">
                <label>Provincia</label>
                <input id="infProvincia" />
              </div>
              <div class="form-field">
                <label>Delegado</label>
                <input id="infDelegado" />
              </div>
              <div class="form-field">
                <label>Tipo</label>
                <select id="infTipo">
                  <option value="Corner">Corner</option>
                  <option value="Exclusivo">Exclusivo</option>
                </select>
              </div>
              <div class="form-field">
                <label>Responsable audio</label>
                <select id="infRespAudio">
                  <option value="">Seleccionar</option>
                  <option value="Ariannys Rojas">Ariannys Rojas</option>
                  <option value="Sonia Guasque">Sonia Guasque</option>
                </select>
              </div>
              <div class="form-field">
                <label>Fecha visita</label>
                <input id="infFecha" type="date" />
              </div>
              <div class="form-field">
                <label>Audi√≥logo</label>
                <input id="infAudiologo" />
              </div>
              <div class="form-field">
                <label>Horas de servicio</label>
                <input id="infHoras" />
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <span>Checklist de visita</span>
            </div>
            <p style="font-size:.8rem; color:var(--text-muted); margin-bottom:6px;">
              Adjunta el checklist del centro (Corner o Exclusivo). El informe usar√° sus datos
              para calcular KPIs y √°reas de mejora.
            </p>
            <input type="file" id="infChecklistFile" accept=".xlsx,.xls" />
            <button class="btn btn-cta-green" style="margin-top:8px;" id="btnAdjuntarChecklist">
              <span class="icon">üìé</span> Adjuntar checklist
            </button>
            <p id="infChecklistEstado" style="font-size:.78rem; margin-top:6px; color:var(--text-muted);">
              Ning√∫n checklist adjunto (demo).
            </p>
          </div>
        </div>

        <!-- Panel 2: KPI barras + radar -->
        <div class="informe-kpi-radar">
          <div class="card informe-kpi-bars">
            <div class="card-header">
              <span>KPIs del centro</span>
            </div>
            <div class="chart-body">
              <canvas id="chartInfKpisCentro"></canvas>
            </div>
          </div>

          <div class="card informe-radar">
            <div class="card-header">
              <span>Radar del centro</span>
            </div>
            <div class="chart-body">
              <canvas id="chartInfRadarCentro"></canvas>
            </div>
          </div>
        </div>

        <!-- Panel 3: checklist interno + im√°genes -->
        <div class="informe-mid-grid">
          <div class="card">
            <div class="card-header">
              <span>Formaciones y habilidades</span>
            </div>
            <div class="checklist-scroll">
              <!-- Formaciones -->
              <div class="checklist-item">
                <input type="checkbox" id="chkWSA" />
                <label for="chkWSA">WSA</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="chkStarkey" />
                <label for="chkStarkey">Starkey</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="chkNeuro" />
                <label for="chkNeuro">Habilidades comerciales / Neuroventas</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="chkHIT" />
                <label for="chkHIT">HIT</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="chkTelecare" />
                <label for="chkTelecare">Telecare</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="chkPIA" />
                <label for="chkPIA">PIA</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="chkTelehear" />
                <label for="chkTelehear">Telehear</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="chkFin" />
                <label for="chkFin">Financiaci√≥n Infinity</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="chkSeguro" />
                <label for="chkSeguro">Venta de seguro</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="chkPrimeros" />
                <label for="chkPrimeros">Primeros auxilios (equipo)</label>
              </div>

              <hr style="border-color:#1f2937; margin:4px 0;" />

              <div style="font-size:.78rem; font-weight:600; margin:4px 0 2px;">
                Producto y comunicaci√≥n
              </div>

              <div class="checklist-item">
                <input type="checkbox" id="chkAudioRT" />
                <label for="chkAudioRT">Audiometr√≠a RT</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="chkTestLectura" />
                <label for="chkTestLectura">Test de lectura audio</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="chkScreening" />
                <label for="chkScreening">Screening audio</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="chkManteleta" />
                <label for="chkManteleta">Manteleta audio</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="chkEscaparate" />
                <label for="chkEscaparate">Escaparate visible audio</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="chkSaludPDV" />
                <label for="chkSaludPDV">Salud auditiva en PDV</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="chkRenove" />
                <label for="chkRenove">Elementos Renove</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="chkMGM" />
                <label for="chkMGM">Elementos MGM</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="chkStock" />
                <label for="chkStock">Stock</label>
              </div>
              <div class="checklist-item">
                <input type="checkbox" id="chkTchin" />
                <label for="chkTchin">Tchin Tchin</label>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <span>Im√°genes del centro</span>
            </div>
            <div class="imagenes-grid">
              <label class="imagen-slot">
                <input type="file" accept="image/*" data-target="imgExterior" />
                <span>Centro exterior<br />Adjuntar imagen</span>
                <img id="imgExterior" style="display:none;" />
              </label>
              <label class="imagen-slot">
                <input type="file" accept="image/*" data-target="imgInterior" />
                <span>Centro interior<br />Adjuntar imagen</span>
                <img id="imgInterior" style="display:none;" />
              </label>
              <label class="imagen-slot">
                <input type="file" accept="image/*" data-target="imgGabinete" />
                <span>Gabinete<br />Adjuntar imagen</span>
                <img id="imgGabinete" style="display:none;" />
              </label>
            </div>
          </div>
        </div>

        <!-- Panel 4: resumen de la visita (3 gr√°ficos) -->
        <div class="card" style="margin-bottom:8px;">
          <div class="card-header">
            <span>Resumen de la visita</span>
          </div>
          <div class="informe-resumen-charts">
            <div class="chart-card" style="padding:0;">
              <div class="chart-title" style="padding:6px 8px 0;">Procesos aplicados</div>
              <div class="chart-body">
                <canvas id="chartInfProcesos"></canvas>
              </div>
            </div>
            <div class="chart-card" style="padding:0;">
              <div class="chart-title" style="padding:6px 8px 0;">√Åreas de mejora</div>
              <div class="chart-body">
                <canvas id="chartInfAreas"></canvas>
              </div>
            </div>
            <div class="chart-card" style="padding:0;">
              <div class="chart-title" style="padding:6px 8px 0;">Conversi√≥n (prueba / venta)</div>
              <div class="chart-body">
                <canvas id="chartInfConversion"></canvas>
              </div>
            </div>
          </div>
        </div>

        <!-- Panel 5: observaciones, recomendaciones, compromisos -->
        <div class="card">
          <div class="card-header">
            <span>Observaciones ¬∑ Recomendaciones ¬∑ Compromisos</span>
          </div>
          <div class="observaciones-grid">
            <div>
              <div style="font-size:.78rem; margin-bottom:2px;">Observaciones</div>
              <textarea id="txtObs"></textarea>
            </div>
            <div>
              <div style="font-size:.78rem; margin-bottom:2px;">Recomendaciones</div>
              <textarea id="txtRec"></textarea>
            </div>
            <div>
              <div style="font-size:.78rem; margin-bottom:2px;">Compromisos</div>
              <textarea id="txtComp"></textarea>
            </div>
          </div>
          <div class="informe-footer-actions">
            <button class="btn btn-cta-green" id="btnGuardarInforme">
              <span class="icon">üíæ</span> Guardar informe
            </button>
          </div>
        </div>

        <!-- Anexo checklist s√≥lo para imprimir -->
        <div id="anexoChecklist" style="display:none; margin-top:10px;">
          <h3 style="font-size:1rem; margin-bottom:4px;">Anexo ¬∑ Checklist de visita</h3>
          <p style="font-size:.8rem; color:var(--text-muted);">
            Aqu√≠ se mostrar√° el contenido del checklist adjunto (demo). En esta versi√≥n s√≥lo se
            indica que el checklist ha sido adjuntado correctamente.
          </p>
        </div>
      </section>

      <!-- P√°ginas vac√≠as -->
      <section id="page-servicios" class="page">
        <div class="page-title">Servicios</div>
        <div class="placeholder-centros">
          Esta secci√≥n se reservar√° para futuros m√≥dulos (Servicios).
        </div>
      </section>

      <section id="page-ventas" class="page">
        <div class="page-title">Ventas</div>
        <div class="placeholder-centros">
          Esta secci√≥n se reservar√° para futuros m√≥dulos (Ventas).
        </div>
      </section>

      <section id="page-proyectos" class="page">
        <div class="page-title">Proyectos</div>
        <div class="placeholder-centros">
          Esta secci√≥n se reservar√° para futuros m√≥dulos (Proyectos).
        </div>
      </section>
    </div>
  </main>

  <script>
    // ========= NAV =========
    const navItems = document.querySelectorAll('#mainNav .nav-item');
    const pages = document.querySelectorAll('.page');

    navItems.forEach(item => {
      item.addEventListener('click', () => {
        const target = item.dataset.page;
        navItems.forEach(i => i.classList.remove('active'));
        item.classList.add('active');
        pages.forEach(p => p.classList.remove('active'));
        document.getElementById(target).classList.add('active');
      });
    });

    // ========= THEME TOGGLE =========
    document.getElementById('themeToggle').addEventListener('click', () => {
      document.body.classList.toggle('light');
    });

    // ========= EXPORTAR HTML (descarga el propio archivo actual) =========
    document.getElementById('btnExportHtml').addEventListener('click', () => {
      const blob = new Blob([document.documentElement.outerHTML], { type: 'text/html;charset=utf-8' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'control-center-audio.html';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    });

    // ========= IMPRIMIR =========
    document.getElementById('btnPrint').addEventListener('click', () => {
      window.print();
    });

    // ========= GUARDAR VISTA (demo) =========
    document.getElementById('btnSaveView').addEventListener('click', () => {
      alert('Vista guardada (demo).');
    });

    // ========= DASHBOARD DEMO DATA =========
    const demoKpiGlobal = {
      procesos: 88,
      prueba: 81,
      venta: 76,
      formaciones: 72,
      aar: 64,
      primeros: 58
    };

    function pintaKpisGlobales() {
      document.getElementById('kpiProcesos').textContent = demoKpiGlobal.procesos + '%';
      document.getElementById('kpiPrueba').textContent = demoKpiGlobal.prueba + '%';
      document.getElementById('kpiVenta').textContent = demoKpiGlobal.venta + '%';
      document.getElementById('kpiFormaciones').textContent = demoKpiGlobal.formaciones + '%';
      document.getElementById('kpiAAR').textContent = demoKpiGlobal.aar + '%';
      document.getElementById('kpiPrimerosAuxilios').textContent = demoKpiGlobal.primeros + '%';
    }
    pintaKpisGlobales();

    const demoDelegados = [
      { nombre: 'Blanca Fdez. de la Pradilla', procesos: 90, prueba: 84, venta: 80, hit: 75, formaciones: 70, aar: 68, primeros: 65 },
      { nombre: 'Sergio Per√°n', procesos: 87, prueba: 82, venta: 79, hit: 72, formaciones: 69, aar: 66, primeros: 62 },
      { nombre: 'Daniel Chazo', procesos: 84, prueba: 80, venta: 76, hit: 70, formaciones: 68, aar: 64, primeros: 60 },
      { nombre: 'Sonia Godino', procesos: 83, prueba: 78, venta: 74, hit: 69, formaciones: 67, aar: 63, primeros: 59 },
      { nombre: 'ENERITZ ARANGUREN', procesos: 83, prueba: 77, venta: 73, hit: 68, formaciones: 66, aar: 62, primeros: 58 }
    ];

    function renderRanking(kpi = 'procesos') {
      const list = document.getElementById('rankingList');
      list.innerHTML = '';
      demoDelegados
        .slice()
        .sort((a,b) => b[kpi] - a[kpi])
        .slice(0,5)
        .forEach((del, idx) => {
          const div = document.createElement('div');
          div.className = 'ranking-item';
          div.innerHTML = `
            <span class="ranking-position">${idx+1}.</span>
            <span class="ranking-name">${del.nombre.split(' ')[0]}</span>
            <div class="ranking-bar-wrap"><div class="ranking-bar" style="width:${del[kpi]}%"></div></div>
            <span class="ranking-value">${del[kpi]}%</span>
          `;
          div.addEventListener('click', () => {
            // al pulsar un delegado, filtramos (demo: s√≥lo alert)
            alert('Filtro por delegado: ' + del.nombre + ' (demo)');
          });
          list.appendChild(div);
        });
    }
    renderRanking('procesos');

    document.querySelectorAll('#rankingKpiSelector .chip').forEach(chip => {
      chip.addEventListener('click', () => {
        document.querySelectorAll('#rankingKpiSelector .chip').forEach(c => c.classList.remove('active'));
        chip.classList.add('active');
        const kpi = chip.dataset.kpi;
        const map = {
          procesos: 'procesos',
          prueba: 'prueba',
          venta: 'venta',
          hit: 'hit',
          formaciones: 'formaciones',
          aar: 'aar',
          primeros: 'primeros'
        };
        renderRanking(map[kpi]);
      });
    });

    // ========= CHARTS DASHBOARD =========
    const labelsMes = ['Ene','Feb','Mar','Abr','May','Jun','Jul','Ago','Sep','Oct','Nov','Dic'];

    const ctxRadarGeneral = document.getElementById('chartRadarGeneral');
    new Chart(ctxRadarGeneral, {
      type: 'radar',
      data: {
        labels: ['Procesos','Conv. prueba','Conv. venta','HIT','Formaciones','AAR'],
        datasets: [{
          label: 'Global',
          data: [88,81,76,72,72,64],
          borderColor: '#38bdf8',
          backgroundColor: 'rgba(56,189,248,0.2)',
          pointBackgroundColor: '#38bdf8'
        }]
      },
      options: {
        plugins: { legend: { display:false } },
        scales: { r: { angleLines:{color:'#1f2937'}, grid:{color:'#1f2937'}, ticks:{display:false} } }
      }
    });

    const ctxProcAreas = document.getElementById('chartProcesosAreas');
    new Chart(ctxProcAreas, {
      type: 'bar',
      data: {
        labels: labelsMes.slice(0,8),
        datasets: [
          {
            type: 'line',
            label: 'Procesos %',
            data: [80,82,83,84,85,86,87,88],
            borderColor: '#38bdf8',
            backgroundColor: 'rgba(56,189,248,0.2)',
            tension: 0.3,
            yAxisID: 'y1'
          },
          {
            type: 'bar',
            label: '√Åreas de mejora',
            data: [6,6,5,5,4,4,3,3],
            backgroundColor: '#f97316',
            yAxisID: 'y'
          }
        ]
      },
      options: {
        plugins: { legend: { display:false } },
        scales: {
          y: { position:'left', beginAtZero:true, grid:{color:'#1f2937'} },
          y1: { position:'right', beginAtZero:true, grid:{display:false}, ticks:{callback:v=>v+'%'} }
        }
      }
    });

    const ctxAreasMes = document.getElementById('chartAreasMes');
    new Chart(ctxAreasMes, {
      type: 'bar',
      data: {
        labels: labelsMes.slice(0,8),
        datasets: [{
          label: '√Åreas de mejora',
          data: [6,6,5,5,4,4,3,2],
          backgroundColor: '#ef4444'
        }]
      },
      options: {
        plugins:{legend:{display:false}},
        scales:{y:{beginAtZero:true,grid:{color:'#1f2937'}}}
      }
    });

    const ctxPrimerosMes = document.getElementById('chartPrimerosMes');
    new Chart(ctxPrimerosMes, {
      type: 'bar',
      data: {
        labels: labelsMes.slice(0,8),
        datasets: [{
          label:'Primeros auxilios %',
          data:[40,45,50,55,60,65,70,75],
          backgroundColor:'#22c55e'
        }]
      },
      options:{
        plugins:{legend:{display:false}},
        scales:{y:{beginAtZero:true, ticks:{callback:v=>v+'%'}, grid:{color:'#1f2937'}}}
      }
    });

    const ctxTopAreas = document.getElementById('chartTopAreas');
    new Chart(ctxTopAreas, {
      type:'bar',
      data:{
        labels:['Seguimiento','Escaparate','Formaci√≥n','Postventa','Citas','Telecare','Screening','Stock','HIT','Tchin'],
        datasets:[{
          data:[7,6,5,4,3,3,2,2,1,1],
          backgroundColor:'#38bdf8'
        }]
      },
      options:{
        indexAxis:'y',
        plugins:{legend:{display:false}},
        scales:{x:{beginAtZero:true,grid:{color:'#1f2937'}}}
      }
    });

    const ctxAarHit = document.getElementById('chartAarHit');
    new Chart(ctxAarHit, {
      type:'doughnut',
      data:{
        labels:['Centros con AAR','Centros con HIT','Otros'],
        datasets:[{
          data:[40,35,25],
          backgroundColor:['#22c55e','#38bdf8','#4b5563']
        }]
      },
      options:{
        plugins:{legend:{position:'bottom', labels:{boxWidth:10,font:{size:10}}}}
      }
    });

    // ========= INFORME DE LA VISITA - GR√ÅFICOS DEMO =========
    const infKpiCtx = document.getElementById('chartInfKpisCentro');
    const chartInfKpis = new Chart(infKpiCtx, {
      type:'bar',
      data:{
        labels:['Procesos','Conv. prueba','Conv. cierre','HIT','Formaciones','AAR','1os auxilios'],
        datasets:[{
          data:[90,82,78,70,75,65,60],
          backgroundColor:['#38bdf8','#38bdf8','#38bdf8','#a855f7','#22c55e','#22c55e','#22c55e']
        }]
      },
      options:{
        plugins:{legend:{display:false}},
        scales:{y:{beginAtZero:true,ticks:{callback:v=>v+'%'},grid:{color:'#1f2937'}}}
      }
    });

    const infRadarCtx = document.getElementById('chartInfRadarCentro');
    const chartInfRadar = new Chart(infRadarCtx, {
      type:'radar',
      data:{
        labels:['Procesos','Conv. prueba','Conv. venta','HIT','Formaciones','AAR'],
        datasets:[{
          data:[90,82,78,70,75,65],
          borderColor:'#38bdf8',
          backgroundColor:'rgba(56,189,248,0.2)',
          pointBackgroundColor:'#38bdf8'
        }]
      },
      options:{
        plugins:{legend:{display:false}},
        scales:{r:{angleLines:{color:'#1f2937'},grid:{color:'#1f2937'},ticks:{display:false}}}
      }
    });

    const infProcCtx = document.getElementById('chartInfProcesos');
    new Chart(infProcCtx,{
      type:'doughnut',
      data:{
        labels:['Aplicados','Pendientes'],
        datasets:[{
          data:[80,20],
          backgroundColor:['#22c55e','#ef4444']
        }]
      },
      options:{plugins:{legend:{position:'bottom',labels:{boxWidth:10,font:{size:10}}}}}
    });

    const infAreasCtx = document.getElementById('chartInfAreas');
    new Chart(infAreasCtx,{
      type:'bar',
      data:{
        labels:['Procesos','Formaci√≥n','HIT','Producto','Comunicaci√≥n'],
        datasets:[{
          data:[3,2,1,2,1],
          backgroundColor:'#ef4444'
        }]
      },
      options:{
        plugins:{legend:{display:false}},
        scales:{y:{beginAtZero:true,grid:{color:'#1f2937'}}}
      }
    });

    const infConvCtx = document.getElementById('chartInfConversion');
    new Chart(infConvCtx,{
      type:'bar',
      data:{
        labels:['Conv. prueba','Conv. venta'],
        datasets:[{
          data:[82,78],
          backgroundColor:['#38bdf8','#22c55e']
        }]
      },
      options:{
        plugins:{legend:{display:false}},
        scales:{y:{beginAtZero:true,ticks:{callback:v=>v+'%'},grid:{color:'#1f2937'}}}
      }
    });

    // ========= INFORME: IM√ÅGENES =========
    document.querySelectorAll('.imagen-slot input[type="file"]').forEach(input => {
      input.addEventListener('change', e => {
        const file = e.target.files[0];
        if (!file) return;
        const targetId = e.target.dataset.target;
        const img = document.getElementById(targetId);
        const reader = new FileReader();
        reader.onload = evt => {
          img.src = evt.target.result;
          img.style.display = 'block';
        };
        reader.readAsDataURL(file);
      });
    });

    // ========= INFORME: CHECKLIST (DEMO) =========
    let checklistAdjunto = false;
    document.getElementById('btnAdjuntarChecklist').addEventListener('click', () => {
      const fileInput = document.getElementById('infChecklistFile');
      if (!fileInput.files.length) {
        alert('Selecciona primero un archivo de checklist.');
        return;
      }
      checklistAdjunto = true;
      document.getElementById('infChecklistEstado').textContent = 'Checklist adjuntado (demo). Los valores del centro se han actualizado.';
      document.getElementById('anexoChecklist').style.display = 'block';
      alert('En la versi√≥n final se leer√°n los KPIs del Excel seg√∫n tu l√≥gica (celdas F / B / I). Ahora es demo visual.');
    });

    // ========= INFORME: GUARDAR (DEMO) =========
    document.getElementById('btnGuardarInforme').addEventListener('click', () => {
      alert('Informe guardado (demo). Se actualizar√≠an el estado de la visita y los promedios del Dashboard.');
    });
  </script>
</body>
</html>
